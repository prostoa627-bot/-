# Мини-веб-приложение Google Apps Script: случайный текст из Google Sheets

## Что делает приложение
- Показывает случайный текст из колонки `A` первого листа таблицы.
- Пропускает строку-заголовок `Text` (первая строка).
- Игнорирует пустые строки.
- Если подходящих строк нет, показывает: `Нет доступных текстов`.

---

## Шаг 1. Откройте Google Sheet
1. Откройте таблицу с ID: `1H0oPMZGqf-sKwbRozzFtLoj_1_gQKXjmgwZSlHBuklk`.
2. Убедитесь, что данные находятся на **первом листе**.
3. Убедитесь, что:
   - в `A1` заголовок `Text`;
   - тексты начинаются со строки `A2`;
   - пустые строки допустимы (приложение их пропустит).

---

## Шаг 2. Откройте редактор Apps Script
1. В открытой таблице нажмите **Extensions** → **Apps Script**.
2. Откроется редактор проекта (в новой вкладке).

---

## Шаг 3. Вставьте код сервера (`Code.gs`)
1. В редакторе слева откройте файл `Code.gs`.
2. Удалите всё, что там есть.
3. Вставьте код из файла `Code.gs` этого репозитория.
4. Нажмите **Save** (иконка дискеты или `Ctrl+S`).

---

## Шаг 4. Создайте HTML-файл интерфейса (`Index.html`)
1. Слева нажмите **+** (рядом с Files) → **HTML**.
2. Введите имя файла: `Index` (получится `Index.html`).
3. Откройте `Index.html`.
4. Вставьте код из файла `Index.html` этого репозитория.
5. Нажмите **Save**.

---

## Шаг 5. Первый запуск и выдача разрешений
1. В верхней панели выберите функцию `getRandomText`.
2. Нажмите **Run**.
3. Появится окно авторизации — нажмите **Review permissions**.
4. Выберите свой Google-аккаунт.
5. Если увидите предупреждение **Google hasn’t verified this app**:
   - нажмите **Advanced**;
   - нажмите **Go to ... (unsafe)**.
6. Нажмите **Allow**.

Это нужно один раз, чтобы скрипт получил доступ к таблице.

---

## Шаг 6. Публикация как Web App
1. Нажмите **Deploy** → **New deployment**.
2. Нажмите иконку-шестерёнку рядом с "Select type" и выберите **Web app**.
3. Заполните параметры:
   - **Description**: например, `Random text app`;
   - **Execute as**: `Me`;
   - **Who has access**: `Anyone` (или `Anyone with Google account`, если нужен вход).
4. Нажмите **Deploy**.
5. В появившемся окне скопируйте **Web app URL** — это и есть ссылка на приложение.

---

## Шаг 7. Использование
1. Откройте URL веб-приложения.
2. Нажмите **Показать случайный текст** — появится случайная строка из таблицы.
3. Нажмите **Копировать**, чтобы скопировать текст в буфер обмена.

---

## Если вы изменили код позже
После изменений нужно обновить деплой:
1. **Deploy** → **Manage deployments**.
2. Выберите текущий deployment.
3. Нажмите **Edit** (иконка карандаша).
4. Выберите новую версию и нажмите **Deploy**.

Ссылка останется той же, но будет открываться обновлённая версия.
